{% extends 'base.html' %}
{% load static %}

{% block page_title %}History & Progress{% endblock %}
{% block page_subtitle %}Review your past conversions and track your learning journey.{% endblock %}

{% block content %}
<div class="space-y-8">
    <!-- Filters & Search -->
    <div class="flex flex-col md:flex-row justify-between items-center gap-4">
        <div class="flex items-center space-x-2 bg-white/5 p-1 rounded-xl border border-white/5">
            <button
                class="px-4 py-2 rounded-lg bg-primary text-white text-sm font-medium shadow-lg shadow-primary/20 transition-all">All</button>
            <button
                class="px-4 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 text-sm font-medium transition-all">PPT
                Uploads</button>
            <button
                class="px-4 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 text-sm font-medium transition-all">Quizzes</button>
        </div>

        <div class="relative w-full md:w-72 group">
            <span
                class="material-icons-round absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-primary transition-colors">search</span>
            <input type="text" placeholder="Search history..."
                class="w-full bg-white/5 border border-white/10 rounded-xl py-2.5 pl-10 pr-4 text-white placeholder-slate-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/50 transition-all">
        </div>
    </div>

    <!-- History Table -->
    <div class="glass-panel rounded-2xl overflow-hidden">
        <div class="overflow-x-auto">
            <table class="w-full text-left text-sm border-separate border-spacing-y-1">
                <thead>
                    <tr class="text-slate-400">
                        <th class="px-6 py-4 font-semibold pl-8">Activity</th>
                        <th class="px-6 py-4 font-semibold whitespace-nowrap">Date</th>
                        <th class="px-6 py-4 font-semibold whitespace-nowrap">Type</th>
                        <th class="px-6 py-4 font-semibold whitespace-nowrap">Status</th>
                        <th class="px-6 py-4 font-semibold text-right pr-8 whitespace-nowrap">Actions</th>
                    </tr>
                </thead>
                <tbody class="">
                    {% for upload in uploads %}
                    <tr class="group hover:bg-white/[0.02] transition-all duration-200">
                        <td
                            class="px-6 py-5 pl-8 first:rounded-l-xl last:rounded-r-xl bg-white/5 border-y border-l border-white/5 group-hover:border-white/10 group-hover:bg-white/10 transition-all">
                            <div class="flex items-center">
                                <div
                                    class="w-12 h-12 flex-shrink-0 rounded-xl bg-orange-500/10 text-orange-400 flex items-center justify-center mr-4 group-hover:scale-105 transition-transform duration-300 border border-orange-500/10">
                                    <span class="material-icons-round">description</span>
                                </div>
                                <div class="min-w-0">
                                    <p
                                        class="text-white font-medium text-base group-hover:text-primary transition-colors truncate pr-4">
                                        {{ upload.title }}</p>
                                    <p class="text-xs text-slate-500 flex items-center mt-0.5">
                                        <span class="w-1.5 h-1.5 rounded-full bg-slate-600 mr-2"></span>
                                        PPTX Presentation
                                    </p>
                                </div>
                            </div>
                        </td>
                        <td
                            class="px-6 py-5 text-slate-400 whitespace-nowrap bg-white/5 border-y border-white/5 group-hover:border-white/10 group-hover:bg-white/10 transition-all">
                            <div class="flex flex-col">
                                <span class="text-white font-medium text-sm">{{ upload.uploaded_at|date:"M d, Y"
                                    }}</span>
                                <span class="text-xs text-slate-500 mt-0.5">{{ upload.uploaded_at|time:"H:i" }}</span>
                            </div>
                        </td>
                        <td
                            class="px-6 py-5 whitespace-nowrap bg-white/5 border-y border-white/5 group-hover:border-white/10 group-hover:bg-white/10 transition-all">
                            <span
                                class="inline-flex items-center px-3 py-1 rounded-lg text-xs font-medium bg-slate-800/50 text-slate-300 border border-white/10">
                                Presentation
                            </span>
                        </td>
                        <td
                            class="px-6 py-5 whitespace-nowrap bg-white/5 border-y border-white/5 group-hover:border-white/10 group-hover:bg-white/10 transition-all">
                            <span
                                class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 shadow-[0_0_10px_rgba(16,185,129,0.1)]">
                                <span class="w-1.5 h-1.5 rounded-full bg-emerald-400 mr-2 animate-pulse"></span>
                                Completed
                            </span>
                        </td>
                        <td
                            class="px-6 py-5 text-right pr-8 whitespace-nowrap first:rounded-l-xl last:rounded-r-xl bg-white/5 border-y border-r border-white/5 group-hover:border-white/10 group-hover:bg-white/10 transition-all">
                            <div
                                class="flex items-center justify-end space-x-2 opacity-80 group-hover:opacity-100 transition-opacity">
                                <a href="{% url 'summary' upload.id %}"
                                    class="inline-flex items-center justify-center w-9 h-9 rounded-lg bg-slate-800/50 hover:bg-primary text-slate-400 hover:text-white transition-all border border-white/5 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/20 tooltip-trigger"
                                    title="View Summary">
                                    <span class="material-icons-round text-[20px]">visibility</span>
                                </a>
                                <a href="{% url 'quiz' upload.id %}"
                                    class="inline-flex items-center justify-center w-9 h-9 rounded-lg bg-slate-800/50 hover:bg-purple-600 text-slate-400 hover:text-white transition-all border border-white/5 hover:border-purple-500/50 hover:shadow-lg hover:shadow-purple-500/20 tooltip-trigger"
                                    title="Take Quiz">
                                    <span class="material-icons-round text-[20px]">psychology</span>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="px-6 py-16 text-center text-slate-500">
                            <div class="flex flex-col items-center justify-center">
                                <div class="w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mb-4">
                                    <span class="material-icons-round text-4xl text-slate-600">history</span>
                                </div>
                                <h3 class="text-white font-medium text-lg mb-1">No history found</h3>
                                <p class="mb-6 max-w-sm mx-auto">Start by uploading a presentation to see your history
                                    here.</p>
                                <a href="{% url 'upload' %}"
                                    class="px-6 py-2.5 rounded-xl bg-primary text-white font-medium shadow-lg shadow-primary/25 hover:bg-primary/90 transition-all flex items-center">
                                    <span class="material-icons-round mr-2">cloud_upload</span>
                                    Upload First PPT
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pagination (Static Placeholder) -->
        {% if uploads.has_other_pages %}
        <div class="px-8 py-5 border-t border-white/5 bg-white/[0.02] flex items-center justify-between">
            <span class="text-sm text-slate-400">Showing all records</span>
            <div class="flex space-x-2">
                <button
                    class="w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center text-slate-500 hover:bg-white/10 hover:text-white transition-colors disabled:opacity-50"
                    disabled>
                    <span class="material-icons-round text-sm">chevron_left</span>
                </button>
                <button
                    class="w-8 h-8 rounded-lg bg-primary text-white flex items-center justify-center shadow-lg shadow-primary/20">1</button>
                <button
                    class="w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center text-slate-500 hover:bg-white/10 hover:text-white transition-colors disabled:opacity-50"
                    disabled>
                    <span class="material-icons-round text-sm">chevron_right</span>
                </button>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}